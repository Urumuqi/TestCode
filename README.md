# 超管配置重构 关注点 part.I

* 根据process类型（比如开服、升级、重启、暂停）产生一份基础配置config_v1（区别全局配置、版本库配置、docker级配置、应用级配置）

* 开服，db读取全局+版本库配置
* 升级，更新db相关配置（若全局配置变动，需要启用新配置）
* 重启、全量拷贝所有需要重启版本库的上一次执行成功的process配置组合
* 暂停、理论上不需要配置（推荐和重启做相同的处理，这样才能通过last_process延续配置）
* 考虑哪些配置在哪种场景下是可以刷新的（比如重启db相关配置是不允许变更的，升级db配置是必须更新的）
* 在config_v1的基础上处理 配置依赖（比如twt依赖amc的db，twt/amc同时依赖超管db/service_name等）重组配置
* 依赖于当前process内的配置
* 依赖于当前impl不同process配置
* 依赖不同impl配置
* 依赖关系可以通过超管直接配置，避免依赖文件
* 实现开服之前对docker配置、依赖配置的正确性校验，大概涉及几个方面
* 服务名称
* 镜像及tag
* 部署环境
* 挂载日志
* 挂载数据路径
* 访问域名
* db
* 配置要实现完整的crud以及搜索、相关跳转定位
* 配置的相关操作要有连续性，入口不能过于分散
* 引入任意process版本，配置对比功能
* 配置与超管业务、流程等实现解偶，用独立的模块/文件夹或者其他方式，通过interface的方式暴露(大致涉及)
* 业务组织层（完成的基础数据的组织）
* config逻辑驱动（组织config执行流程）
* config依赖业务层（完成对依赖数据的解析封装）
* 业务暴露(暴露必要接口，获取config核心数据)
* view展示和配置层
* 运用oop的方式、考虑数据的变化而不是代码的改变
* 配置的标准数据输入输出（比如配置下发进证书、或者通过第三方配置系统下发业务系统）

> ps: 超管系统核心是对配置的管理和维护，配置系统的灵活、清晰、易用是超管整体质量的体现，关乎超管的长期稳定